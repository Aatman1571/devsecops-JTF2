groups:
  - name: windows_alerts
    rules:
      - alert: HighCPUUsage
        expr: 100 - (avg by(instance)(rate(windows_cpu_time_total{mode="idle"}[1m])) * 100) > 75
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "High CPU Usage"
          description: "CPU usage > 75% for 1 minute on {{ $labels.instance }}"

  - name: ci_pipeline_alerts
    rules:
      - alert: PipelineFailed
        expr: ci_pipeline_status{status="failure"} == 1
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "CI Pipeline Failed"
          description: "A GitHub Actions job has failed."

  - name: security_scan_alerts
    rules:  
      - alert: SecurityScanFailed
        expr: security_scan_status{status="failure"} == 1
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "Security Scan Failed"
          description: "One or more security scans failed in the pipeline."
